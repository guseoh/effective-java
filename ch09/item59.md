### ✅ 라이브러리를 익히고 사용하라

자바에서 제공하는 라이브러리나 외부 라이브러리든 이를 사용할 때 주의할 점이나 사용법을 제대로 알지 못하면 예상치 못한 문제를 겪곤 합니다.

예를 들어, 간단한 랜덤한 정수를 생성하기 위해 자바 라이브러리인 `Random`을 사용하는 코드입니다.

```java
static Random r = new Random();

static int random(int n) {
    return Math.abs(r.nextInt() % n);
}
```

해당 코드는 별 문제 없어 보이지만 3가지 문제점을 내포하고 있습니다.

1. `n`이 그리 크지 않은 2의 제곱수라면 얼마 지나지 않아 같은 수열을 반복합니다.
2. `n`이 2의 제곱수가 아니라면 몇몇 숫자가 평균적으로 더 자주 반환됩니다. 만약 `n` 값이 크면 이 현상은 더 두드러진다.
3. 지정한 범위 '바깥'의 수가 종종 튀어나올 수 있습니다.

이렇게 라이브러리를 잘못 사용하면 논리 문제, 버그, 성능 저하가 발생할 수 있습니다.

<details>
    <summary>더보기</summary>
<div markdown="1">

```java
    static Random rnd = new Random();

static int random(int n) {
    return Math.abs(rnd.nextInt()) % n;
}

@Test
void example() {
    int n = 2 * (Integer.MAX_VALUE / 3);
    int low = 0;

    for (int i = 0; i < 1000000; ++i) {
        if (random(n) < n / 2) {
            low++;
        }
    }
    System.out.println(low);
}
```

정상적인 테스트 결과는 약 500,000 값이 나와야 합니다. 하지만 해당 테스트 코드를 실행하면 약 666,666 값이 나오는 걸 볼 수 있습니다. 이는 무작위 숫자가 2/3가량 중간값보다 낮은 쪽으로 쏠린 걸
의미합니다.


</div>
</details>

3번째 문제를 조금 풀어서 이야기하자면 `r.nextInt()`의 범위는 `Integer.MIN_VALUE`부터 `Integer.MAX_VALUE`까지의 난수를 생성합니다.
일반적으로 `xx % n`를 사용하는건 0 ~ n-1를 값을 사용하기 위한이며, `Math.abs()`는 음수를 양수로 바꾸기 위해 사용합니다.
이때 `Math.abs(-2,147,483,648)` 값이 생성되면 이 값은 절댓값으로 바꿀 수 없는 문제가 발생합니다. 왜냐하면 `int`의 범위인 32비트 정수 범위를 벗어나기 때문입니다.

### 표준 라이브러리 사용 시 장점

1. 다양한 학습 자료와 활용 사례
2. 핵심적인 일과 크게 관련 없는 문제를 해결하느라 시간을 허비하지 않아도 됩니다.
3. 따로 노력하지 않아도 성능이 지속해서 개선
4. 버전이 업그레이드 될 수록 다양한 기능을 사용할 수 있습니다.
5. 많은 사람들이 사용하기 때문에 남들이 코드를 볼 때 이해하기 쉽습니다.

#### 이 책에서 개인적인 생각

이런 장점을 볼 때 표준 라이브러리를 도입하는게 좋아 보이지만 실제 현업에서는 직접 구현해서 사용하고 있습니다. 아마도 이런 라이브러리 존재 여부를 모르기 때문입니다.  
예를 들어, 자바 9에 도입된 `InputStream`에 `transferTo()`은 지정한 URL의 내용을 완벽히 가져오며, 자바 7에 도입된 `ThreadLocalRandom`은 성능 향상과 멀티 쓰레드 환경에서
발생하는 문제를 효율적으로 해결했습니다.

결론: 특별한 기능을 개발하는 게 아니라면 웬만하면 이미 라이브러리 형태로 구현해 놓았을 가능성이 크므로, 해당 라이브러리를 잘 찾아보고 사용해라